<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta name="google-site-verification" content="WIBYTs2Vy14HvrnHixbBGSFenycHFvmqQKvWEK4PogU"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="lanourain"><title>spring-in-action(3rd)_note | Lanourain's blog</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/5.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">spring-in-action(3rd)_note</h1><a id="logo" href="/.">Lanourain's blog</a><p class="description">I fight, so you don't have to.</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">spring-in-action(3rd)_note</h1><div class="post-meta">May 27, 2016<span> | </span><span class="category"><a href="/categories/Java/">Java</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a data-disqus-identifier="2016/05/27/spring-in-action-3rd-note/" href="/2016/05/27/spring-in-action-3rd-note/#disqus_thread" class="disqus-comment-count"></a><div class="post-content"><h4 id="Spring-根本使命："><a href="#Spring-根本使命：" class="headerlink" title="Spring 根本使命："></a>Spring 根本使命：</h4><ul>
<li>简化java开发</li>
</ul>
<h4 id="Spring-关键策略："><a href="#Spring-关键策略：" class="headerlink" title="Spring 关键策略："></a>Spring 关键策略：</h4><ul>
<li>基于POJO的轻量级和最小侵入性编程</li>
<li>通过依赖注入和面向接口编程实现松耦合</li>
<li>通过面向切面和惯例实现声明式编程</li>
<li>通过面向切面和模板减少样板式代码</li>
</ul>
<h3 id="依赖注入-dependency-injection"><a href="#依赖注入-dependency-injection" class="headerlink" title="依赖注入(dependency injection)"></a>依赖注入(dependency injection)</h3><p><strong>应用对象之间的解耦。</strong><br>DI是依赖反转（IoC,Inversion of Control）在Spring中的实现方式</p>
<ul>
<li>依赖反转：一个对象的合作（依赖）对象的引用或依赖关系的管理由具体对象来完成，则会导致代码的高耦合和难测试性，应该把这些依赖关系的注入交给框架或者IoC容器来完成。当对象被创建时，由一个调控系统内的所有对象的外界实体将其所依赖的对象的引用传递给它，即依赖被注入到对象中。反转是关于一个对象如何获取它所依赖的对象的引用，指责任的反转，由自己管理变成容器管理。</li>
</ul>
<p>解决代码过度耦合。软件组件保持松散耦合。</p>
<p>通过接口来实现依赖关系，注入不同的实现类。</p>
<p>装配：创建应用组件之间协作的行为。</p>
<h3 id="应用切面-Applying-aspects"><a href="#应用切面-Applying-aspects" class="headerlink" title="应用切面(Applying aspects)"></a>应用切面(Applying aspects)</h3><p><strong>横切关注点与影响对象之间的解耦。</strong><br>Aspect-oriented programming 面向切面编程<br>提取遍布系统的关注点（日志，安全等），不混在应用组件的核心业务中。<br>动态和非侵入性的方式增强服务的功能。</p>
<h3 id="模板"><a href="#模板" class="headerlink" title="模板"></a>模板</h3><p>使用模板消除样板式代码。（类似提取出模板代码，然后只要传入参数给模板就好了）</p>
<h3 id="spring容器-container"><a href="#spring容器-container" class="headerlink" title="spring容器(container)"></a>spring容器(container)</h3><p>容器负责创建，装配，配置，管理对象的生命周期。<br>容器使用DI管理构成应用的组件，创建相互协作的组件之间的关联。<br>容器实现类型：</p>
<ul>
<li>Bean 工厂（Bean factories，org.springframework.beans.factory.BeanFactory），基本容器，提供基本的DI支持。</li>
<li>应用上下文（Application contexts org.springframework.context.ApplicationContext），基于BeanFactory构建。可以从类路径，文件系统，web应用下读取相应的XML文件并装载上下文定义。</li>
</ul>
<h3 id="Bean生命周期"><a href="#Bean生命周期" class="headerlink" title="Bean生命周期"></a>Bean生命周期</h3><p>在不同生命阶段都可以对Bean进行个性化定制。<br>相应步骤我们可以做什么？参考Q9中在不同阶段做了哪些自定义。<br><img src="https://i.imgur.com/sdZwoes.jpg" alt=""></p>
<p><img src="https://i.imgur.com/FrjkaLe.jpg" alt=""></p>
<p><img src="https://i.imgur.com/FQY5kCs.jpg" alt=""><br><img src="https://i.imgur.com/CicmZCc.jpg" alt=""></p>
<h3 id="spring-组成模块"><a href="#spring-组成模块" class="headerlink" title="spring 组成模块"></a>spring 组成模块</h3><p><img src="https://i.imgur.com/7WOflrT.jpg" alt=""></p>
<h3 id="装配Bean"><a href="#装配Bean" class="headerlink" title="装配Bean"></a>装配Bean</h3><p>创建应用对象之间协作关系（依赖关系）的行为被称为装配（wiring）（DI的本质）<br>装配方式：</p>
<ul>
<li>XML中显式配置</li>
<li>Java中显式配置</li>
<li>隐式的Bean发现机制和自动装配（尽可能多的使用，显式配置越少越好）</li>
</ul>
<h4 id="装配配置思路："><a href="#装配配置思路：" class="headerlink" title="装配配置思路："></a>装配配置思路：</h4><ul>
<li>自动装配，对于被标记的bean，spring会自动装配到容器中，并装配到相应的依赖bean中。<ul>
<li>所以需要在相应需要装配的bean上打上对应的标记（打上@Component，）</li>
<li>再创建配置文件告诉spring去哪个区域内查找需要被装配的bean（配置类@Configuration + @ComponentScan，xml + component-scan，）</li>
<li>同时把这个配置上下文文件加载到spring中（@ContextConfiguration）</li>
<li>最后再标记需要被装配的依赖bean（@Autowired）</li>
</ul>
</li>
<li>Java显示配置，告诉spring应用上下文中如何创建bean，相当于就是帮Spring实现了new 方法。<ul>
<li>创建一个配置类（@Configuration）</li>
<li>在配置类中添加需要加载的bean（@Bean）</li>
<li>同时把这个配置上下文文件加载到spring中（@ContextConfiguration）</li>
</ul>
</li>
</ul>
<h4 id="自动化装配Bean"><a href="#自动化装配Bean" class="headerlink" title="自动化装配Bean"></a>自动化装配Bean</h4><ul>
<li>组件扫描：自动发现应用上下文中所创建的bean</li>
<li>自动装配：自动满足bean之间的依赖，找到多个满足依赖关系的bean时会抛异常</li>
<li>显示装配：<ul>
<li>Java配置</li>
<li>XML配置</li>
</ul>
</li>
</ul>
<p><img src="https://i.imgur.com/qU32FwU.jpg" alt=""></p>
<ul>
<li><p>声明Bean（使用<bean>元素在spring配置文件中进行声明，spring会创建一个对象，对应bean_id的Bean，spring调用构造器来实例化Bean，<constructor-arg>来传入参数(基本类型或者bean)选择使用相应的构造器）（@Configuration + @Bean替代<beans> 的配置文件）</beans></constructor-arg></bean></p>
</li>
<li><p>默认情况下，所有spring Bean都是单例，通过给Bean声明作用域来覆盖spring的单例配置（如允许Bean的定义可以被实例化任意次，每次调用都创建一个实例）spring的单例Bean只能保证每个应用上下文中只有一个Bean的实例，通过定义多个<bean>声明可以实例化同一个Bean。</bean></p>
</li>
<li><p>初始化和销毁Bean （两种方式在spring bean生命周期中都属于相应的步骤）</p>
<ul>
<li>init-method 初始化时操作  destroy-method 销毁时操作</li>
<li>Bean实现Spring的InitializingBean和DisposableBean来实现初始化和销毁时操作，spring自动检测实现接口的Bean，无需额外操作，但是Bean与spring API产生耦合。建议在开发一个明确在Spring容器内使用的框架Bean时使用？</li>
</ul>
</li>
<li>注入Bean属性(spring通过调用set方法来配置属性)<ul>
<li><property></property></li>
<li>使用命名空间 p 装配</li>
</ul>
</li>
<li>装配集合<br><img src="https://i.imgur.com/JPjeSBW.jpg" alt=""></li>
</ul>
<h3 id="最小化spring-xml配置（消除xml配置）"><a href="#最小化spring-xml配置（消除xml配置）" class="headerlink" title="最小化spring xml配置（消除xml配置）"></a>最小化spring xml配置（消除xml配置）</h3><ul>
<li>自动装配<br><img src="https://i.imgur.com/Q0RtEZp.jpg" alt=""><ul>
<li>注解装配<ul>
<li>@Autowired</li>
<li>@Qualifier 修饰bean</li>
<li>@Value 装配string或基本类型，配合SpEl使用</li>
</ul>
</li>
</ul>
</li>
<li>自动检测<ul>
<li><context:component-scan> 指定package，扫描指定的包找出能够自动注册为Bean的类。可以使用annotation + 自动检测Bean和定义Bean<br><img src="https://i.imgur.com/OI9626X.jpg" alt=""></context:component-scan></li>
</ul>
</li>
</ul>
<ul>
<li>高级装配<ul>
<li>激活特定的profile来创建特定的bean</li>
<li>使用@Conditional 满足某些条件的情况下才装配bean</li>
</ul>
</li>
</ul>
<h3 id="面向切面的Spring"><a href="#面向切面的Spring" class="headerlink" title="面向切面的Spring"></a>面向切面的Spring</h3><p>分布于应用中多处的功能称为横切关注点，这些功能需要应用到系统多个模块中，如日志、安全和事务管理等，但是不该由对象模块主动调用，横切关注点应该和模块的业务逻辑分开，这正是面向切面编程需要解决的。</p>
<p>面向切面编程：独立定义一个通用功能(切面)，声明该功能以何种方式在何处应有，无需修改受影响的类。相应类只需要关心自身功能代码就可。</p>
<p>使用AOP，切面可以在不修改spring bean的条件下为其添加新功能(@DeclareParents)。</p>
<ul>
<li><p>AOP组成</p>
<ul>
<li>通知(Advice)：定义了切面是什么以及何时使用，Spring提供5种种通知类型，区分通知的时间。定义切面什么时候何时使用，需要做什么。</li>
<li>连接点(join point)：应用中能够插入通知的点</li>
<li>切点(pointcut)：应用中需要插入进行通知的点，定义了在何处进行通知。</li>
<li>切面（aspect）：通知和切点的结合，定义什么在何时和何处完成什么功能。</li>
<li>引入(introduction)：使用通知给现有类添加新方法或属性。</li>
<li>织入(weaving)：将切面应用到目标对象来创建新的代理对象的过程。</li>
</ul>
</li>
<li><p>Spring提供的AOP支持</p>
<ul>
<li>基于代理的AOP</li>
<li>@AspectJ注解驱动的切面（AspectJ切点表达式）</li>
<li>纯POJO切面</li>
<li>注入式AspectJ切面</li>
</ul>
</li>
<li>Spring AOP构建在动态代理基础上，在运行时通知对象，使用代理类封装目标类，拦截被通知的方法的调用，执行额外的切面逻辑，再将调用转发给目标类。</li>
<li>因为Spring基于动态代理实现，所以Spring只支持方法连接点。如有高级的使用场景（构造器或属性拦截），则考虑使用AspectJ来实现切面。</li>
<li>Spring切点编写：<ul>
<li>Spring AOP使用AspectJ的切点表达式来定义切点<br><img src="https://i.imgur.com/mYsKK1V.jpg" alt=""></li>
<li>编写切点：<br><img src="https://i.imgur.com/RpgSQDm.jpg" alt=""><br><img src="https://i.imgur.com/ivjxlEe.jpg" alt=""><br><img src="https://i.imgur.com/TyjNxSd.jpg" alt=""></li>
<li>XML中声明切面<br><img src="https://i.imgur.com/72Za5H5.jpg" alt=""></li>
<li>使用注解创建切面。</li>
</ul>
</li>
</ul>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://lanourain.github.io/2016/05/27/spring-in-action-3rd-note/" data-id="cjary9yr5001tw98obxqlrt4p" class="article-share-link">Share</a><div class="tags"><a href="/tags/Java/">Java</a><a href="/tags/Spring/">Spring</a></div><div class="post-nav"><a href="/2016/07/04/Facts-and-fallacies-of-software-engineering/" class="pre">《软件工程的事实与谬论》读书笔记</a><a href="/2016/05/16/The-Willpower-Instinct-note/" class="next">《自控力》笔记</a></div><div id="disqus_thread"><script>var disqus_shortname = 'lanourain@gmail.com';
var disqus_identifier = '2016/05/27/spring-in-action-3rd-note/';
var disqus_title = 'spring-in-action(3rd)_note';
var disqus_url = 'http://lanourain.github.io/2016/05/27/spring-in-action-3rd-note/';
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//lanourain@gmail.com.disqus.com/count.js" async></script></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://lanourain.github.io"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/Management/" style="font-size: 15px;">Management</a> <a href="/tags/daily/" style="font-size: 15px;">daily</a> <a href="/tags/jdk/" style="font-size: 15px;">jdk</a> <a href="/tags/软件工程/" style="font-size: 15px;">软件工程</a> <a href="/tags/Git/" style="font-size: 15px;">Git</a> <a href="/tags/版本管理/" style="font-size: 15px;">版本管理</a> <a href="/tags/动漫/" style="font-size: 15px;">动漫</a> <a href="/tags/历史/" style="font-size: 15px;">历史</a> <a href="/tags/SVN/" style="font-size: 15px;">SVN</a> <a href="/tags/jvm/" style="font-size: 15px;">jvm</a> <a href="/tags/Team/" style="font-size: 15px;">Team</a> <a href="/tags/java/" style="font-size: 15px;">java</a> <a href="/tags/ansible/" style="font-size: 15px;">ansible</a> <a href="/tags/Reading/" style="font-size: 15px;">Reading</a> <a href="/tags/effective-java/" style="font-size: 15px;">effective java</a> <a href="/tags/design-patterns/" style="font-size: 15px;">design_patterns</a> <a href="/tags/Java/" style="font-size: 15px;">Java</a> <a href="/tags/Spring/" style="font-size: 15px;">Spring</a> <a href="/tags/业务/" style="font-size: 15px;">业务</a> <a href="/tags/project/" style="font-size: 15px;">project</a> <a href="/tags/bit/" style="font-size: 15px;">bit</a> <a href="/tags/algorithm/" style="font-size: 15px;">algorithm</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/12/04/同城散送业务浅析/">同城散送业务浅析</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/08/HashMap/">HashMap && Hashtable浅析</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/02/Git-Base/">Git基础</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/03/Intro-SVN/">SVN简介</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/27/ArrayList-And-LinkedList/">ArrayList和LinkedList浅析</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/21/JVM-2-GC/">深入理解Java虚拟机 - 垃圾收集器与内存分配策略</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/20/JVM-1-Memory-Model/">深入理解Java虚拟机 - Java内存模型</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/18/effective-java/">effective java 笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/17/singleton/">单例模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/17/promise_patterns/">Promise模式</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> Recent Comments</i></div><script type="text/javascript" src="//lanourain@gmail.com.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Blogroll</i></div><ul></ul><a href="http://blog.yongbin.me/" title="El Psy Congroo" target="_blank">El Psy Congroo</a><ul></ul><a href="https://majiahui.github.io/" title="Jiahui's Blog" target="_blank">Jiahui's Blog</a><ul></ul><a href="http://czmonster.com/" title="Day Day Up" target="_blank">Day Day Up</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">Lanourain's blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>